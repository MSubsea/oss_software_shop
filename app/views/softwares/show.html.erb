<div class="container mt-5 bg-dark text-white">
  <div class="d-flex flex-row m-5">
    <div style="width: 50%; height: 100%" class="card-info-show">
      <h1 class="p-2 text-white">
      <% if @software.customer.present? %>
        <%= @software.customer.name %>
      <% end %>
      <%= @software.title %>
      </h1>
      <% if @software.photo.key.present? %>
        <%= cl_image_tag @software.photo.key, height: 200, width: 200, crop: :fill %>
      <% end %>
      <p class="p-2"><%= @software.description %></p>
    </div>
    <div style="width: 50%; height: 300 px "
        class="card-info-map"
        data-controller="mapbox"
        data-mapbox-markers-value="<%= @geojson.to_json %>"
        data-mapbox-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>

  <hr>

  <%= link_to 'Softwares Overview', softwares_path(), class: "btn btn-primary" %>
  <%= link_to 'Customer Overview', customer_path(@software.customer), class: "btn btn-secondary"%>
  <% if policy(@software).edit? %>
    <%= link_to 'Edit', edit_software_path(@software)%>
  <% end %>
  <% if policy(@software).destroy? %>
    <%= link_to "Delete",
            software_path(@software),
            method: :delete,
            data: { confirm: "Are you sure?" } %>
  <% end %>
  <% if policy(Release).new? %>
    <%= link_to "Add new release", new_software_release_path(@software)%>
  <% end %>
  <hr>
  <h4 class="p-2 text-white">Available Releases</h4>
  <% @software.releases.each do |release| %>
    <div class="card m-2 p-2">
      <h3><%= release.version_number %></h3>
      <% release.reviews.each do |review| %>
        <ul class="list-group list-group-flush">
          <li class="list-group-item list-group-item-action d-flex justify-content-between align-items-center border-0"><%= review.comment %>
          <span class="badge bg-dark rounded-pill"><%= review.rating %></span></li>
        </ul>
      <% end %>
      <%= link_to "Download", release.software_url %>
      <% if policy(release).edit? %>
        <%= link_to "Update release", edit_release_path(release) %>
      <% end %>
      <% if policy(Review).new? %>
        <%= link_to "Create Review", new_release_review_path(release) %>
      <% end %>
    </div>
  <% end %>
</div>
